<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treemap</title>
    <link href="styles.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>  
    

    <!--    https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/kickstarter-funding-data.json
            https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/movie-data.json
            https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/video-game-sales-data.json  -->

<script type="module">
    import * as d3 from 'https://cdn.jsdelivr.net/npm/d3@7/+esm'

   const DataPromise = d3.json('/json/movie-data.json')     



   function treeMap(dataset) {

    const width = 900;
    const height = 800;

    const fader = (color) => d3.interpolateRgb(color, '#fff')(0.3);
    const colourScale = d3.scaleOrdinal(d3.schemeCategory10.map(fader))


    const root = d3.hierarchy(dataset).sum((d) => d.value)

    console.log(dataset)

    console.log(root)

    console.log(root.leaves())

    const titleContainer = d3.select('body')
    .append('div')
    
    titleContainer.append('h2')
    .attr('id', 'title')
    .text('Movies and their Revenues')

    titleContainer.append('h4')
    .attr('id', 'description')
    .text('Top 95 movies to be in fact')

    const container = d3.select('body')
    .append('div')
    .attr('id', 'my-svg')

    const svg = container.append('svg')
    .attr('width', width)
    .attr('height', height)

    const cell = svg.selectAll('g')
    .data(root.leaves())
    .enter()
    .append('g')

    d3.treemap()
    .size([width, height])
    .padding(1)
    (root)

    cell.selectAll('rect')
    .data(root.leaves())
    .enter()
    .append('rect')
    .attr('x', (d) => d.x0)
    .attr('y', (d) => d.y0)
    .attr('width', (d) => d.x1 - d.x0)
    .attr('height', (d) => d.y1 - d.y0)
    .attr('fill', (d) => colourScale(d.data.category))
    .attr('class', 'tile')
    
    cell.selectAll('text')
    .data(root.leaves())
    .enter()
    .append('text')
    .attr('x', (d) => d.x0+3)
    .attr('y', (d) => d.y0+20)
    .attr('font-size', 12)
    .text((d) => d.data.name)







   }

   
  



    DataPromise.then(function (data) {
        const dataset = data;
        // console.log(dataset)
        treeMap(dataset);
    })



</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>